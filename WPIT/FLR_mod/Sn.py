"""
FLR_mod.Sn
_____________________________________________________________________________________________________________________
**Description**:

Calculate the magnetic field line length
_____________________________________________________________________________________________________________________
**Inputs**:

L: L shell
s: cosine of polar angle from z-axis
Bm: 
a: 
_______________________________________________________________________________________________________________________
**Outputs**:

FL_len: field line length in m
________________________________________________________________________________________________________________________

**Reference**:

________________________________________________________________________________________________________________________

"""

import numpy as np
from WPIT.Environment_mod import const
from WPIT.FLR_mod as flr

def Sn(L, s, Bm, a):
    
    Bm=50.0e-9
    sm = flr.sm(L)
    fN = flr.fN(L)
    
    scale = Bm*(sm+sm**3)**(1/2)*(1-sm**2)**(3/2)/(1+3*sm**2)**(1/2)
    
    return scale*a*np.sin(fN*(s+s**3))
