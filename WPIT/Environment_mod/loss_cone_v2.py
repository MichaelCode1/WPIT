"""
initial_velocity.loss_conev2

**Description**:
_____________________________________________________________________________________________________________________

Routine to calculate the loss cone angle

_____________________________________________________________________________________________________________________
_____________________________________________________________________________________________________________________

**Inputs**:
_____________________________________________________________________________________________________________________

L_arg: L shell
_______________________________________________________________________________________________________________________
_______________________________________________________________________________________________________________________

**Outputs**:
_____________________________________________________________________________________________________________________

loss: loss cone angle in rad
_____________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

**Reference**:
_____________________________________________________________________________________________________________________
Lauben, D. S., Inan, U. S., and Bell, T. F. (2001). Precipitation of radiation belt electrons induced by
obliquely propagating lightning-generated whistlers. Journal of Geophysical Research: Space Physics
106, 29745â€“29770
_____________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

"""
import numpy as np
from WPIT.Environment_mod import const


def loss_cone_v2(L_arg,h_arg):
    zeta_m=(const.Re+h_arg)/(L_arg*const.Re)
    facsqrt=np.sqrt(1+3*(1-zeta_m))
    sinalc_sq=(zeta_m**3)/facsqrt
    sinalc=np.sqrt(sinalc_sq)
    loss=np.arcsin(sinalc)

    return loss
