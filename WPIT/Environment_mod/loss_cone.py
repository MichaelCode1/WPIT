"""
initial_velocity.loss_cone

**Description**:
_____________________________________________________________________________________________________________________

Routine to calculate the loss cone angle

_____________________________________________________________________________________________________________________
_____________________________________________________________________________________________________________________

**Inputs**:
_____________________________________________________________________________________________________________________

L_arg: L shell
_______________________________________________________________________________________________________________________
_______________________________________________________________________________________________________________________

**Outputs**:
_____________________________________________________________________________________________________________________

loss: loss cone angle in rad
_____________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

**Reference**:
_____________________________________________________________________________________________________________________
Kivelson, Margaret G., Margaret Galland Kivelson, and Christopher T. Russell, eds. Introduction to space physics. Cambridge university press, 1995.
_____________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

"""

import numpy as np


def loss_cone(L_arg):
    fac=1/np.sqrt(L_arg**3*np.sqrt(4-3/L_arg))
    loss=np.arcsin(fac)

    return loss
