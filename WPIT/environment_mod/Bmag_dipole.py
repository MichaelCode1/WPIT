"""
environment_mod.Bmag_dipole

**Description**:
_____________________________________________________________________________________________________________________

Routine to calculate the geomagnetic dipole field strength

_____________________________________________________________________________________________________________________
_____________________________________________________________________________________________________________________

**Inputs**:
_____________________________________________________________________________________________________________________

L_arg: L shell

lamda_arg: magnetic latitude in rad
_______________________________________________________________________________________________________________________
_______________________________________________________________________________________________________________________

**Outputs**:
_____________________________________________________________________________________________________________________

Bmag: Geomagnetic dipole field in T

_____________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

**Reference**:

_____________________________________________________________________________________________________________________
Parks G K 1991 Physics of Space Plasmas. An Introduction 1st edn (Redwood City, CA: Addison Wesley), p. 54
_____________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

"""

import numpy as np

def Bmag_dipole(L_arg,lamda_arg):
    
   
    B0=31200*10**(-9)
    slat=np.sin(lamda_arg)
    clat=np.cos(lamda_arg)
    slat_term = np.sqrt(1 + 3*slat*slat)
    Bmag=(B0/(L_arg**3))*slat_term/(clat**6)

    return Bmag
